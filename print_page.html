
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.10">
    
    
      
        <title>Print Site - hpc@azure</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="css/print-site.css">
    
      <link rel="stylesheet" href="css/print-site-material.css">
    
    <script>__md_scope=new URL("/",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="hpc@azure" class="md-header__button md-logo" aria-label="hpc@azure" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            hpc@azure
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/seareport/hpc@azure" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="hpc@azure" class="md-nav__button md-logo" aria-label="hpc@azure" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    hpc@azure
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/seareport/hpc@azure" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="infra.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infra
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="provisioning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Provisioning
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="docs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    <span class="md-ellipsis">
      1. Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infra" class="md-nav__link">
    <span class="md-ellipsis">
      2. Infra
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#provisioning" class="md-nav__link">
    <span class="md-ellipsis">
      3. Provisioning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docs" class="md-nav__link">
    <span class="md-ellipsis">
      4. Documentation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-hpcazure">HPC@Azure<a class="headerlink" href="#index-hpcazure" title="Permanent link">&para;</a></h1>
<p>This repo contains Infrastructure-as-a-Code (IaaC) for deploying an HPC cluster on Azure.</p>
<p>The code has been developed in order to support the pre-operational phase of the <a href="#.">Seareport</a> Project. 
We’ve extracted the core of the codebase and made it available in this repository, hoping it might serve others as well.</p>
<p>During this process, we’ve simplified several aspects and removed implementation specific details.
For instance, Seareport deploys <a href="https://github.com/ec-jrc/Thalassa">Thalassa</a>,
a web application designed for visualizing large scale sea level data on unstructured mesh data.
However, this specific application may not be useful for other projects,
so we’ve replaced this component with a placeholder, in this case, an empty Virtual Machine.</p>
<p>In the same spirit, the actual code that provisions the other VMs and the HPC cluster has been removed. 
What this repository offers is a straightforward way to replicate Seareport’s high-level design.
To extract value from it, you’ll need to tailor it to your specific needs.</p>
<h2 id="index-objectives">Objectives<a class="headerlink" href="#index-objectives" title="Permanent link">&para;</a></h2>
<p>The main objectives include:</p>
<ul>
<li>Facilitating the effortless deployment of two separate HPC instances that can be dynamically scaled according to demand.</li>
<li>Utilizing the first HPC instance for the execution of a model in an “operational” mode 
    (for instance, running the model bi-daily) and for the storage and distribution of the outcomes.</li>
<li>Employing the second HPC instance to aid in the ongoing refinement of the model.</li>
</ul>
<p>It is crucial that these two HPC instances operate independently of each other.
Any “development” tasks should be conducted in a manner that does not disrupt or interfere with the operational setup.</p>
<p>To achieve this goal a Bicep-based IaaC (Infrastructure-as-a-Code) solution has been developed.</p>
<h2 id="index-repository-directory-structure">Repository directory structure<a class="headerlink" href="#index-repository-directory-structure" title="Permanent link">&para;</a></h2>
<p>There are three main directories:</p>
<ul>
<li>The <code>infra</code> directory contains the bicep modules that manage the creation of resources on Azure</li>
<li>The <code>provisioning</code> directory contains code helpers that can be used to provision the VMs using <code>ansible</code>. 
  This directory only contains sample playbooks.
  The actual provisioning is omitted since it is application/project specific.</li>
<li>The <code>docs</code> directory contains the code that generates the current document.</li>
</ul>
<h2 id="index-prerequisites">Prerequisites<a class="headerlink" href="#index-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/bicep/install#azure-cli">Azure cli</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/bicep/install">Azure bicep</a></li>
<li><a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html">ansible</a> for provisioning (optional)</li>
<li>python 3 for building docs</li>
</ul></section><section class="print-page" id="infra"><h1 id="infra-infrastructure">Infrastructure<a class="headerlink" href="#infra-infrastructure" title="Permanent link">&para;</a></h1>
<h2 id="infra-quick-start">Quick start<a class="headerlink" href="#infra-quick-start" title="Permanent link">&para;</a></h2>
<ol>
<li>Determine the Azure Subscription ID and the correct Tenant ID for your subscription using these
    <a href="https://learn.microsoft.com/en-us/azure/azure-portal/get-subscription-tenant-id">instructions</a></li>
<li>Login to Entra ID with azure-cli. The tenant UUID is the one you determined in step 1. E.g.:
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>login<span class="w"> </span>--tenant<span class="w"> </span>1647eb98-698c-4714-b3b5-8cc15f794d36
</code></pre></div></li>
<li>Ensure that everything worked as expected:
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>account<span class="w"> </span>show
</code></pre></div></li>
<li>Enter the <code>infra</code> directory:
<div class="highlight"><pre><span></span><code>cd infra
</code></pre></div></li>
<li>
<p>Edit the <code>main.bicepparam</code> file and fill in appropriate values to it.
   At the very least you should change <code>project</code> and the SSH public key value.
   You can identify the principal IDs by using a command like this:
   <div class="highlight"><pre><span></span><code> az ad user show --id &#39;George.Breyiannis.ec.europa.eu#EXT#@europeancommissionhotmai379.onmicrosoft.com&#39;
</code></pre></div></p>
</li>
<li>
<p>Deploy the infrastructure with the following command (it requires confirmation):
<div class="highlight"><pre><span></span><code>az deployment sub create -c --template-file main.bicep --parameters main.bicepparam
</code></pre></div></p>
</li>
</ol>
<p>After a couple of minutes everything should be up and running.</p>
<!-- ## High level design -->
<!---->
<!-- ![High Level Setup](img/high_level_setup.png) -->

<h2 id="infra-design">Design<a class="headerlink" href="#infra-design" title="Permanent link">&para;</a></h2>
<p>The high level diagram of the infrastructure can be seen in the following image.</p>
<p><img alt="High Level Networking" src="img/networking.png" /></p>
<h3 id="infra-networking-and-security">Networking and Security<a class="headerlink" href="#infra-networking-and-security" title="Permanent link">&para;</a></h3>
<p>When it comes to networking, the important points are:</p>
<ul>
<li>There are two VNets, <code>oper</code> and <code>dev</code>. Communication between the VNets is not permitted.</li>
<li>There is a Keyvault for storing secrets. The Keyvault is only accessible from within the VNets.</li>
<li>The <code>oper</code> VNet has two Subnets: <code>public</code> which is accessible from the internet and <code>compute</code> where the HPC cluster is running.
  Direct communication between the two Subnets is not permitted. 
  If the VMs of the <code>public</code> subnet need data they should read them from the storage account where the VMs of the <code>compute</code> subnet wrote them to.</li>
<li>The <code>dev</code> VNet only has the <code>compute</code> subnet. </li>
</ul>
<h3 id="infra-storage">Storage<a class="headerlink" href="#infra-storage" title="Permanent link">&para;</a></h3>
<p>As we can see there are 3 Storage Accounts: </p>
<ul>
<li><code>pub-sa</code> where the operational cluster stores the data that are meant to be disseminated to 3rd parties</li>
<li><code>oper-sa</code> where the operational cluster stores that data that are needed for its operation</li>
<li><code>dev-sa</code> where the development cluster stores that data that are needed for its operation</li>
</ul>
<p>It should be noted that:</p>
<ul>
<li>The operational cluster does not have access to <code>dev-sa</code></li>
<li>The development cluster has RO only access to <code>pub-sa</code> and <code>dev-sa</code>. 
  The idea is that if there is any issue with the model output, the developers of the model should be able to access the data 
  in order to debug it. The same is true for input data. You probably only want to store them once in <code>oper-sa</code></li>
</ul>
<h3 id="infra-public-subnet">Public Subnet<a class="headerlink" href="#infra-public-subnet" title="Permanent link">&para;</a></h3>
<p>In the current implementation the <code>Public SNet</code>  is very simple. It has just a single VM which is being used to read data from 
<code>pub-sa</code> and visualize them via a web-app.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The actual deployment of the web application is omitted since it is implementation specific.</p>
</div>
<p><img alt="Public Subnet" src="img/public_snet.png" /></p>
<h3 id="infra-compute-subnet">Compute Subnet<a class="headerlink" href="#infra-compute-subnet" title="Permanent link">&para;</a></h3>
<p><img alt="Oper Compute Subnet" src="img/oper_compute_snet.png" /></p>
<h2 id="infra-naming-conventions">Naming conventions<a class="headerlink" href="#infra-naming-conventions" title="Permanent link">&para;</a></h2>
<p>This naming convention is intended to bring uniformity and predictability to resource deployment and management.
It supports efficient searching, sorting, and automation processes, 
making it easier for users and systems to navigate our Azure infrastructure.</p>
<p>This section explains the structure of the naming convention and the rationale behind it 
to help users understand how to locate and identify Azure resources within the system.</p>
<h3 id="infra-naming-structure">Naming Structure<a class="headerlink" href="#infra-naming-structure" title="Permanent link">&para;</a></h3>
<p>The general pattern for naming Azure resources is as follows:</p>
<div class="highlight"><pre><span></span><code>{project}-{environment}-{domain}-[{identifier}-]{resource_suffix}
</code></pre></div>
<p>Each segment of the naming pattern plays a specific role:</p>
<ul>
<li>
<p><code>{project}</code>: This is the project identifier, a shorthand for the project or application to which the resource belongs.
  Please keep it short (3-5 chars) since Azure has relatively short limits for Storage Accounts names.</p>
</li>
<li>
<p><code>{environment}</code>: Resources are categorized by the environment they reside in.
  The environments we make use of are <code>dev</code> for development and <code>oper</code> for operational or production.
  There is also the <code>common</code> environment which contains resources that are not environment-specific
  (e.g. Keyvault and Storage accounts).</p>
</li>
<li>
<p><code>{domain}</code>: This denotes the functional area or service that the resource is a part of,
  such as <code>net</code> for network-related resources, <code>storage</code> for storage-related resources etc.</p>
</li>
<li>
<p><code>{identifier}</code>: Used when there are multiple similar resources that need differentiation, 
  such as two subnets or network security groups within the same <code>domain</code>. 
  For example, <code>public</code> and <code>compute</code> are identifiers that help distinguish between different subnets.</p>
</li>
<li>
<p><code>{resource_suffix}</code>: This is a short code that represents the type of Azure resource.</p>
</li>
</ul>
<h3 id="infra-special-considerations">Special Considerations<a class="headerlink" href="#infra-special-considerations" title="Permanent link">&para;</a></h3>
<p>Due to Azure requirements, Storage Account names cannot contain hyphens and must be globally unique. 
With the naming pattern we use you shouldn't run into duplicates, but in the rare chance that you do
try to use a different value in <code>project</code>.</p>
<h3 id="infra-list-of-suffixes">List of suffixes<a class="headerlink" href="#infra-list-of-suffixes" title="Permanent link">&para;</a></h3>
<p>The suffixes that we make use of are:</p>
<ul>
<li><code>rg</code> for Resource Groups</li>
<li><code>vm</code> for Virtual Machines</li>
<li><code>vmss</code> for Virtual Machine Scale Sets</li>
<li><code>vnet</code> for Virtual Networks</li>
<li><code>snet</code> for Subnets</li>
<li><code>nsg</code> for Network Security Groups</li>
<li><code>kv</code> for Keyvaults</li>
<li><code>sa</code> for Storage Accounts</li>
<li><code>nic</code> for Network Interfaces</li>
<li><code>pip</code> for Public IP Addresses</li>
</ul>
<h2 id="infra-resources-and-resource-groups">Resources and Resource groups<a class="headerlink" href="#infra-resources-and-resource-groups" title="Permanent link">&para;</a></h2>
<h3 id="infra-list-of-resourcegroups">List of <code>ResourceGroups</code><a class="headerlink" href="#infra-list-of-resourcegroups" title="Permanent link">&para;</a></h3>
<p>After deployment you should end up with the following Resource Groups:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nv">PROJECT</span><span class="o">=</span>aaa
$<span class="w"> </span>az<span class="w"> </span>group<span class="w"> </span>list<span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;[?starts_with(name, &#39;</span><span class="si">${</span><span class="nv">PROJECT</span><span class="si">}</span><span class="s2">&#39;)].name&quot;</span><span class="w"> </span>--output<span class="w"> </span>table
aaa-common-keyvault-rg
aaa-common-storage-dev-rg
aaa-common-storage-oper-rg
aaa-common-storage-pub-rg
aaa-dev-compute-rg
aaa-dev-network-rg
aaa-oper-compute-rg
aaa-oper-network-rg
aaa-oper-visual-rg
</code></pre></div>
<h3 id="infra-list-of-resources">List of <code>Resources</code><a class="headerlink" href="#infra-list-of-resources" title="Permanent link">&para;</a></h3>
<p>After deployment you should end up with the following Resources:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nv">PROJECT</span><span class="o">=</span>aaa
$<span class="w"> </span>az<span class="w"> </span>resource<span class="w"> </span>list<span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;[?starts_with(name, &#39;</span><span class="si">${</span><span class="nv">PROJECT</span><span class="si">}</span><span class="s2">&#39;)].name&quot;</span><span class="w"> </span>--output<span class="w"> </span>tsv<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort
</code></pre></div></section><section class="print-page" id="provisioning"><h1 id="provisioning-provisioning">Provisioning<a class="headerlink" href="#provisioning-provisioning" title="Permanent link">&para;</a></h1>
<h2 id="provisioning-dependency-installation">Dependency installation<a class="headerlink" href="#provisioning-dependency-installation" title="Permanent link">&para;</a></h2>
<h2 id="provisioning-authentication">Authentication<a class="headerlink" href="#provisioning-authentication" title="Permanent link">&para;</a></h2>
<h2 id="provisioning-playbook-execution">Playbook execution<a class="headerlink" href="#provisioning-playbook-execution" title="Permanent link">&para;</a></h2></section></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "/", "features": [], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
    
  </body>
</html>